game.GameoverScreen=me.ScreenObject.extend({init:function(){this.parent(!0),this.bg=null},onResetEvent:function(){this.bg=me.loader.getImage("ts_bg"),me.input.bindKey(me.input.KEY.ENTER,"start",!0),me.input.bindTouch(me.input.KEY.ENTER,!0),this.rankingText=new game.GameoverScreen.RankingText(me.game.viewport.width/2,28),this.rankText=new game.GameoverScreen.RankText(me.game.viewport.width/2,450),zz=me.game.viewport.width/2,this.cursorText=new game.GameoverScreen.CursorText(zz,258),game.data.bestscore<game.data.score&&(game.data.bestscore=game.data.score,this.textin()),$.get("scores.php?q=rank",function(a){game.data.rank=a},"text"),$.get("scores.php?q=player",function(a){""!=a&&(game.data.player=a),zz+=16*game.data.player.length+15},"text"),$("body").keypress(function(a){var b=String.fromCharCode(a.charCode).toUpperCase();switch(b){case"\xc4":b="AE";break;case"\xd6":b="OE";break;case"\xdc":b="UE"}zz+=16,game.data.player+=b}),$("body").keydown(function(a){switch(a.which){case 8:if(0==game.data.player.length)break;game.data.player=game.data.player.substring(0,game.data.player.length-1),zz-=16;break;case 32:game.data.player+=" ",zz+=16}})},textin:function(){var a=new me.Tween(this.rankText).to({textScale:.8},1e3).onComplete(this.textout.bind(this));a.easing(me.Tween.Easing.Quadratic.InOut),a.start()},textout:function(){var a=new me.Tween(this.rankText).to({textScale:.9},1e3).onComplete(this.textin.bind(this));a.easing(me.Tween.Easing.Quadratic.InOut),a.start()},update:function(){return me.input.isKeyPressed("start")&&($.ajax({type:"POST",url:"scores.php?q=player",data:{name:game.data.player}}),me.state.change(me.state.SCORE)),this.rankingText.update(),this.rankText.update(),this.cursorText.update(),!0},draw:function(a){a.drawImage(this.bg,0,0),this.rankingText.draw(a),this.rankText.draw(a),this.cursorText.draw(a)},onDestroyEvent:function(){$("body").unbind("keypress"),$("body").unbind("keydown")}}),game.GameoverScreen.StartText=me.Renderable.extend({init:function(a,b){this.parent(new me.Vector2d(a,b),10,10),this.font=new me.BitmapFont("font",{x:32,y:32}),this.font.alignText="bottom",this.font.set("center",1),this.textScale=1,this.floating=!0},update:function(){return this.font.resize(this.textScale),!0},draw:function(a){this.font.draw(a,"GAMEOVER",this.pos.x,this.pos.y)}}),game.GameoverScreen.RankingText=me.Renderable.extend({init:function(a,b){this.parent(new me.Vector2d(a,b),10,10),this.font=new me.BitmapFont("font",{x:32,y:32}),this.font.alignText="top",this.font.set("center",1),this.textScale=1,this.floating=!0},update:function(){return this.font.resize(this.textScale),!0},draw:function(a){this.font.draw(a,"GAME OVER\n\n\n\n\nNAME:\n\n"+game.data.player,this.pos.x,this.pos.y)}}),game.GameoverScreen.RankText=me.Renderable.extend({init:function(a,b){this.parent(new me.Vector2d(a,b),10,10),this.font=new me.BitmapFont("font",{x:32,y:32}),this.font.alignText="bottom",this.font.set("center",1),this.textScale=1,this.floating=!0},update:function(){return this.font.resize(this.textScale),!0},draw:function(a){game.data.score==game.data.bestscore?this.font.draw(a,game.data.score+" COINS GESAMMELT!\n\nPLATZ "+game.data.rank,this.pos.x,this.pos.y):(this.textScale=.8,this.font.draw(a,"NUR "+game.data.score+" COINS GESAMMELT\n\nDER EIGENE REKORD LIEGT BEI "+game.data.bestscore+" COINS",this.pos.x,this.pos.y))}}),game.GameoverScreen.CursorText=me.Renderable.extend({init:function(a,b){this.parent(new me.Vector2d(a,b),10,10),this.font=new me.BitmapFont("font",{x:32,y:32}),this.font.alignText="bottom",this.font.set("center",1),this.textScale=1,this.floating=!0,this.textin()},update:function(){return this.font.resize(this.textScale),!0},draw:function(a){this.font.draw(a,"_",zz,this.pos.y)},textin:function(){var a=new me.Tween(this).to({textScale:.8},500).onComplete(this.textout.bind(this));a.easing(me.Tween.Easing.Quadratic.InOut),a.start()},textout:function(){var a=new me.Tween(this).to({textScale:1},500).onComplete(this.textin.bind(this));a.easing(me.Tween.Easing.Quadratic.InOut),a.start()}});