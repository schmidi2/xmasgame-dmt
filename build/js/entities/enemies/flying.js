game.FlyingEnemy=me.ObjectEntity.extend({init:function(a,b,c){this.parent(a,b,c),this.renderable.anim={};for(var d=new Array,e=0;e<c.walkframes;e++)d[e]=e;for(var f=new Array,e=0;e<c.dieframes;e++)f[e]=c.walkframes+e;this.renderable.addAnimation("walk",d),this.renderable.addAnimation("die",f),this.renderable.setCurrentAnimation("walk"),this.updateColRect((c.spriteheight-80)/2,80,(c.spriteheight-60)/2-10,60),this.setVelocity(5,0),this.setMaxVelocity(5,15),this.collidable=!0,this.spawning=!1,this.type=me.game.ENEMY_OBJECT,this.health=c.hp,this.dying=!1,this.canKnockback=!1,this.knockbackTime=0,this.gravity=0,this.alwaysUpdate=!1,this.flipX(!0)},onCollision:function(a,b){this.alive&&!this.renderable.isFlickering()&&!this.dying&&this.knockbackTime<=0&&(b.attacking||b instanceof game.ProjectileEntity?(b instanceof game.ProjectileEntity&&me.game.remove(b),this.canKnockback&&this.knockback(this.pos.x+this.renderable.hWidth-(b.pos.x+b.renderable.hWidth)),this.health--,this.health>0?this.renderable.flicker(45):this.die()):b instanceof game.PlayerEntity&&b.die())},update:function(){if(this.inViewport&&(this.alwaysUpdate=!0),!this.alive||this.dying||this.spawning?this.vel.x=0:this.vel.x+=-this.accel.x*me.timer.tick,this.knockbackTime>0?(this.vel.x>0&&(this.vel.x-=.1),this.vel.x<0&&(this.vel.x+=.1),this.knockbackTime-=me.timer.tick,this.dying||(this.renderable.animationpause=!0,this.renderable.setAnimationFrame(0))):(this.maxVel.x=5,this.dying||(this.renderable.animationpause=!1)),!this.spawning){var a=this.updateMovement();0!=a.x&&this.die()}return this.dying&&this.renderable.anim.die.idx==this.renderable.anim.die.length-1&&(this.renderable.animationpause=!0,this.renderable.alpha-=.01,this.renderable.alpha<=.01&&me.game.remove(this)),0!=this.vel.x||0!=this.vel.y||this.dying||this.knockback>0||this.spawning?(this.parent(),!0):!1},knockback:function(a){a>0&&(a=1),0>a&&(a=-1),this.maxVel.x=20,this.vel.x=5*a,this.knockbackTime=45},die:function(){this.dying=!0,this.gravity=.98,this.renderable.setCurrentAnimation("die"),game.data.score+=50}});